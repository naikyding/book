(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{507:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"參考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#參考"}},[t._v("#")]),t._v(" 參考")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000012774650",target:"_blank",rel:"noopener noreferrer"}},[t._v("next.js、nuxt.js 等服务端渲染框架构建的项目部署到服务器，并用 PM2 守护程序"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000012675012",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue、react 等单页面项目应该这样子部署到服务器"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.npmjs.com/package/pm2",target:"_blank",rel:"noopener noreferrer"}},[t._v("PM2 NPM"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://nuxtjs.org/faq/deployment-pm2",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to deploy using PM2 cluster mode?"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://ken551113.github.io/2019/12/03/Using-PM2-To-Deploy-Nuxt.js-Project/",target:"_blank",rel:"noopener noreferrer"}},[t._v("利用 PM2 部署 Nuxt.js 專案"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://tn710617.github.io/zh-tw/pm2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PM2 用法大全"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install"}},[t._v("#")]),t._v(" install")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pm2 -g\n")])])]),a("h2",{attrs:{id:"啟動"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#啟動"}},[t._v("#")]),t._v(" 啟動")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pm2 start app.js\npm2 start app.js --name my-api       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 啟動的 server 名稱 --name projectName")]),t._v("\npm2 start app.js -i "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据CPU核数启动进程个数")]),t._v("\npm2 start app.js --watch             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 实时监控app.js的方式启动，当app.js文件有变动时，pm2会自动reload")]),t._v("\n")])])]),a("h2",{attrs:{id:"停止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止"}},[t._v("#")]),t._v(" 停止")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pm2 stop all                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#停止PM2列表中所有的进程")]),t._v("\npm2 stop "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("                           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#停止PM2列表中进程为0的进程")]),t._v("\n")])])]),a("h2",{attrs:{id:"刪除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#刪除"}},[t._v("#")]),t._v(" 刪除")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pm2 delete "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除PM2列表中进程为0的进程")]),t._v("\npm2 delete all                       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除PM2列表中所有的进程")]),t._v("\npm2 del "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 刪除指定進程")]),t._v("\n")])])]),a("hr"),t._v(" "),a("h2",{attrs:{id:"使用-pm2-開發-nuxt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-pm2-開發-nuxt"}},[t._v("#")]),t._v(" 使用 pm2 開發 NUXT")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("package.json")]),t._v(" 新增指令"),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nuxt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pm2dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"pm2 start npm --name 'nuxt-project' -i 8 --watch -- run dev\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nuxt build"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nuxt start"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("--name [這個服務的名稱]")]),t._v(" 你 APP 的名稱。")]),t._v(" "),a("li",[a("code",[t._v("-i [核心數]")]),t._v(" 你想要這個服務，用幾個核心數來啟動。")]),t._v(" "),a("li",[a("code",[t._v("--watch")]),t._v(" 檔案有變更時，會自動重新啟動")])])]),t._v(" "),a("li",[t._v("輸入指令 "),a("code",[t._v("npm run pm2dev")]),t._v(" 開始享受開發吧!")])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"使用-pm2-部署-nuxt-參考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-pm2-部署-nuxt-參考"}},[t._v("#")]),t._v(" 使用 pm2 部署 nuxt "),a("a",{attrs:{href:"https://nuxtjs.org/docs/2.x/deployment/deployment-pm2",target:"_blank",rel:"noopener noreferrer"}},[t._v("參考"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("使用 PM2（Process Manager 2）進行部署是一種快速簡便的解決方案，用於將通用 Nuxt 應用程序託管在服務器或 VM 上。")]),t._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"#%E5%8F%83%E8%80%83"}},[t._v("安裝 "),a("code",[t._v("pm2")])])])]),t._v(" "),a("li",[a("p",[t._v("專案底下新增 "),a("code",[t._v("ecosystem.config.js")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  apps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NuxtAppName'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      exec_mode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cluster'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      instances"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'max'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// or a number of instances")]),t._v("\n      script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/nuxt/bin/nuxt.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      args"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'start'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("專案建構與啟動 serve")]),t._v(" "),a("ul",[a("li",[t._v("建構 "),a("code",[t._v("npm run build")])]),t._v(" "),a("li",[t._v("啟動服務 "),a("code",[t._v("pm2 start")])]),t._v(" "),a("li",[t._v("查看狀態 "),a("code",[t._v("pm2 ls")]),t._v("\n你的應用程式正在服務中")])])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[t._v("此解決方案保證該服務器上的應用程序不停機。您應該通過冗餘或高可用性雲解決方案來防止服務器發生故障。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);